var h=void 0,j=null,l=this.self||global;function m(a){switch(a||2){case 2:n(l,m["2"])}}function q(){for(var a=[],b=0,c=this.length;b<c;++b)b in this&&(a[b]=this[b]);return a}function r(a){a=this.indexOf(a);return 0>a?h:a}function s(a,b){for(var c=0,d=this.length;c<d;++c)if(a(this[c],c,this))return this[c];return b?b(this):h}function u(){for(var a=[],b=0,c=this.length;b<c;++b){var d=this[b];d===d&&d!==j&&d!==h&&0>a.indexOf(d)&&a.push(d)}return a}
function v(a){a|=0;return this.length&&0<a?Array(a+1).join(this):""}function w(){for(var a=[],b=0,c=this.length;b<c;++b)a.push(this.charCodeAt(b));return a}function x(a,b){b=b===h?"\n":b;var c=j,c=""===b?this.e(b).split("\r\n\r\n"):b===j||b===h?[this.valueOf()]:this.e(b).split(b);return"function"===typeof a?(c.forEach(a),this):c}
function y(){var a="",a=new z;arguments.length&&a.set([].slice.call(arguments));for(var a=a.get().a,b=[],c=this.valueOf(),d="",f=0,e=c.length;f<e;++f){var g=c[f];(!a||0<=a.indexOf(g))&&d===g||(d!==g&&(d=g),b.push(g))}return b.join("")}function A(a){var b=["g"],b=b||[];if("string"===typeof a)return RegExp(a,b.join(""));a.global&&b.push("g");a.multiline&&b.push("m");a.ignoreCase&&b.push("i");return RegExp(a.source,b.join(""))}function z(a){this.c={};this.b=[];this.set(a)}
function B(a,b){C(this,a).forEach(b)}function C(a,b,c){var d=[],f=a|0;a=f>b;var e=(a?b:f)|0,f=(a?f:b)|0,g=typeof c,k=1;if("function"===g)for(;e<=f;++e)c(e)&&d.push(e);else{"number"===g&&(k=c|0);if(1>k||2147483647<=b)throw Error("invalid Number#to(,step)");for(;e<=f;e+=k)d.push(e)}return a?d.reverse():d}var D="process"in l,n=l.Extend||require("uupaa.extend.js");m.name="Ruby";m.repository="https://github.com/uupaa/Ruby.js";
m["2"]={Array:{prototype:{times:function(a){for(var b=[],c=0;c<a;++c)b.push(this);return[].concat(b)},all:Array.prototype.every,any:Array.prototype.some,at:function(a){return 0>a?this[this.length+a]||h:this[a]||h},assoc:function(a){for(var b=0,c=this.length;b<c;++b)if(b in this&&this[b][0]===a)return this[b]},clear:function(){this.length=0;return this},clone:q,collect:Array.prototype.map,compact:function(){for(var a=[],b=0,c=this.length;b<c;++b)if(b in this){var d=this[b];d===d&&(d!==h&&d!==j)&&a.push(d)}return a},
cycle:function(a,b){for(var c=[],d=0,f=0;f<a;++f)for(var e=0,g=this.length;e<g;++e)if(e in this){var k=this[e];b&&b(k,d++);c.push(k)}return c},detect:s,delete_at:function(a){return this.splice(a,1)},delete_if:function(a){var b=this.reduce(function(b,d,f){a(d,f)||b.push(d);return b},[]);this.length=0;Array.prototype.push.apply(this,b);return this},dup:q,each:Array.prototype.forEach,each_index:Array.prototype.forEach,each_with_index:Array.prototype.forEach,empty:function(){return!this.length},eql:function(a){if(this.length!==
a.length)return!1;for(var b=0,c=this.length;b<c;++b)if(this[b]!==a[b])return!1;return!0},find:s,find_index:r,index:r,first:function(){return this.length?this[0]:h},include:function(a){return 0<=this.indexOf(a)},to_s:Array.prototype.toString,last:function(){return this.length?this[this.length-1]:h},map:Array.prototype.map,select:Array.prototype.filter,to_a:Array.prototype.f,uniq:u}},String:{prototype:{times:v,ascii_only:function(){for(var a=0,b=this.length;a<b;++a)if(127<this.charCodeAt(a))return!1;
return!0},capitalize:function(){return this.slice(0,1).toUpperCase()+this.slice(1).toLowerCase()},center:function(a,b){if(a<=this.length)return this.valueOf();var c=a-this.length,d=c/2|0,c=c/2+0.5|0,f=v.call(b||" ",a).slice(0,a);return f.slice(0,d)+this+f.slice(-c)},chars:function(){return this.split("")},chomp:function(a){a=a===h?"\n":a;switch(a){case j:return this.valueOf();case "\n":return this.replace(/(\r\n|\r|\n)$/,"");case "":return this.replace(/(\r\n|\r|\n)+$/,"")}return this.replace(RegExp(a),
"")},chop:function(){var a=this.length;return 2<=a&&"\r"===this[a-2]&&"\n"===this[a-1]?this.slice(0,-2):this.slice(0,-1)},chr:function(){return this[0]},codepoints:w,count:function(){var a=(new z).set([].slice.call(arguments)).get().a;return this.match(RegExp("["+a+"]","g")).length},"delete":function(){var a=(new z).set([].slice.call(arguments)).get().a;return this.replace(RegExp("["+a+"]","g"),"")},downcase:String.prototype.toLowerCase,each_char:function(a){var b=this.split("");return"function"===
typeof a?(b.forEach(a),this):b},each_codepoint:function(a){var b=w.call(this);return"function"===typeof a?(b.forEach(a),this):b},each_line:x,end_with:function(){var a=this.valueOf();return[].slice.call(arguments).some(function(b){var c=a.length-b.length;return a.lastIndexOf(b,c)===c?!0:!1})},eql:function(a){return this.valueOf()===a},gsub:function(a,b){if(0<=b.indexOf("\\&"))throw Error("unsupported replace character");var c=A(a);b=b.replace(/\\(\d)/g,"$$1");return this.replace(c,b)},hex:function(){return parseInt(this.replace(/_/g,
""),16)||0},include:function(a){return 0<=this.indexOf(a)},index:String.prototype.indexOf,insert:function(a,b){return this.slice(0,a)+b+this.slice(a)},size:function(){return this.length},lines:x,ljust:function(a,b){return a<=this.length?this.valueOf():(this+v.call(b||" ",a)).slice(0,a)},lstrip:function(){return this.replace(/^[ \t\r\n\f\v\0]+/,"")},ord:function(){if(!this.length)throw Error("String#ord() empty string");return this.charCodeAt(0)},partition:function(a){var b=this.indexOf(a);return 0<=
b?[this.slice(0,b),a,this.slice(b+a.length)]:[this.valueOf(),"",""]},reverse:function(){return this.split("").reverse().join("")},rindex:String.prototype.lastIndexOf,rjust:function(a,b){return a<=this.length?this.valueOf():(v.call(b||" ",a)+this).slice(-a)},rpartition:function(a){var b=this.lastIndexOf(a);return 0<=b?[this.slice(0,b),a,this.slice(b+a.length)]:["","",this.valueOf()]},rstrip:function(){return this.replace(/[ \t\r\n\f\v\0]+$/,"")},scan:function(a,b){for(var c=A(a),d=this.valueOf(),f=
[],e=j,g=0;(e=c.exec(d))!==j;)1<e.length?(Array.prototype.push.apply(f,[e.slice(1)]),b&&b(e.slice(1),g++)):(f.push(e[0]),b&&b(e[0],g++));return f},squeeze:y,start_with:function(){var a=this.valueOf();return[].slice.call(arguments).some(function(b){return 0===a.indexOf(b)?!0:!1})},strip:function(){return this.replace(/^[ \t\r\n\f\v]+/,"").replace(/[ \t\r\n\f\v\0]+$/,"")},swapcase:function(){return this.replace(/(?:([A-Z])|([a-z]))/g,function(a,b,c){return b?b.toLowerCase():c.toUpperCase()})},to_f:function(){return parseFloat(this.replace(/_/g,
""))||0},to_i:function(a){var b=this.valueOf();if(a!==h)if(0===a){switch(b.slice(0,2)){case "0b":a=2;break;case "0o":a=8;break;case "0d":a=10;break;case "0x":a=16}a&&(b=b.slice(2));!a&&"0"===b[0]&&(a=8,b=b.slice(1))}else b=b.replace(/^(0b|0o|0d|0x)/,"");return parseInt(b,a||10)||0},to_s:String.prototype.toString,to_str:String.prototype.toString,tr:function(a,b){for(var c=(new z(a)).get(),d=(new z(b)).get(),f=[],e=this.valueOf().split(""),g=0,k=e.length;g<k;++g){var p=e[g];c.d[p]?f.push(d.a[c.a.indexOf(p)]||
d.a[d.a.length-1]||""):f.push(p)}return f.join("")},tr_s:function(a,b){for(var c=(new z(a)).get(),d=(new z(b)).get(),f=[],e=[],g=this.valueOf().split(""),k=0,p=g.length;k<p;++k){var t=g[k];c.d[t]?e.push(d.a[c.a.indexOf(t)]||d.a[d.a.length-1]||""):(e.length&&(f.push(y.call(e.join(""))),e.length=0),f.push(t))}e.length&&f.push(y.call(e.join("")));return f.join("")},upcase:String.prototype.toUpperCase}},Number:{prototype:{to_s:function(a){return this.toString(a||10)},upto:B,downto:B,step:function(a,b,
c){+this>a?C(this,a,-b).forEach(c):C(this,a,b).forEach(c)}}}};u.call([].concat(Object.keys(m["2"].Array.prototype),Object.keys(m["2"].String.prototype),Object.keys(m["2"].Number.prototype))).forEach(function(a){m[a]=function(b){var c="string"===typeof b?"String":"number"===typeof b?"Number":Array.isArray(b)?"Array":"";return m["2"][c].prototype[a].call(b,[].slice.call(arguments,1))}});
z.prototype={get:function(){return{d:this.c,a:this.b.join("")}},set:function(a){function b(a,b){b&&("^"===b[0]?(b=b.slice(1),/\w-\w/.test(b)?a.removeRange(b):a.remove(b)):/\w-\w/.test(b)?a.addRange(b):a.add(b))}var c=this;Array.isArray(a)?a.forEach(function(a){b(c,a)}):"string"===typeof a&&b(this,a);return this},add:function(a){a=a.split("");for(var b=0,c=a.length;b<c;++b){var d=a[b];this.c[d]=1;0>this.b.indexOf(d)&&this.b.push(d)}return this},addRange:function(a){var b=a.charCodeAt(0);for(a=a.charCodeAt(2);b<=
a;++b){var c=String.fromCharCode(b);this.c[c]=1;0>this.b.indexOf(c)&&this.b.push(c)}return this},remove:function(a){a=a.split("");for(var b=0,c=a.length;b<c;++b){var d=a[b];delete this.c[d];d=this.b.indexOf(d);0<=d&&this.b.splice(d,1)}return this},removeRange:function(a){var b=a.charCodeAt(0);for(a=a.charCodeAt(2);b<=a;++b){var c=String.fromCharCode(b);delete this.c[c];c=this.b.indexOf(c);0<=c&&this.b.splice(c,1)}return this}};D&&(module.exports=m);l.Ruby?l.Ruby_=m:l.Ruby=m;
